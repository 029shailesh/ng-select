<div (click)="open()" class="as-control">


    <span class="as-multi-value-wrapper">

        <span class="as-placeholder" *ngIf="showPlaceholder()">{{placeholder}}</span>

        <div class="as-value" *ngIf="!searchValue">
            <span *ngIf="selectedItem" class="as-value-label" role="option" aria-selected="true">
                <ng-template *ngIf="displayTemplateRef" [ngTemplateOutlet]="displayTemplateRef.template"
                              [ngOutletContext]="getDisplayTemplateContext()"></ng-template>

                <ng-container *ngIf="!displayTemplateRef">{{getTextValue()}}</ng-container>
            </span>
        </div>

        <div *ngIf="!isDisabled" class="as-input">
            <input #filterInput
                   [value]="filterValue"
                   (input)="onFilter($event)"
                   (focus)="onInputFocus($event)"
                   (blur)="onInputBlur($event)"
                   role="combobox"
                   aria-expanded="false"
                   aria-owns=""
                   aria-haspopup="false">
        </div>
    </span>

    <span *ngIf="allowClear && selectedItem" (click)="clear()" class="as-clear-zone" title="Clear all" aria-label="Clear all"><span class="as-clear">Ã—</span></span>
    <span class="as-arrow-zone"><span class="as-arrow"></span></span>

    <input type="hidden" name="selected-state" value="south-australia-TODO">
</div>


<div class="as-menu-outer" [ngStyle]="{'visibility': isOpen ? 'visible' : 'hidden'}">
    <virtual-scroll role="listbox" class="as-menu" [bufferAmount]="4" [items]="filteredItems" (update)="viewPortItems = $event">
        <div class="as-option" role="option" (click)="select(item)"
             *ngFor="let item of viewPortItems; let index = index; let first = first; let last = last; let even = even; let odd = odd"
             [class.disabled]="item.disabled"
             [class.selected]="item == selectedItem">

            <ng-container *ngIf="!optionTemplateRef">{{item[bindLabel]}}</ng-container>

            <ng-template *ngIf="optionTemplateRef" [ngTemplateOutlet]="optionTemplateRef.template"
                          [ngOutletContext]="getOptionTemplateContext(item, index, first, last, even, odd)">
            </ng-template>
        </div>
    </virtual-scroll>

    <div class="as-menu" *ngIf="filteredItems.length === 0">
        <div class="as-option disabled">
            No items found
        </div>
    </div>
</div>
